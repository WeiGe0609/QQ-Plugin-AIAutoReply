AI自动回复 (QFun / QStory)

本项目是基于兼容 OpenAI 格式 API 的真人化 QQ 自动回复机器人。支持私聊/群聊，能区分不同群友，并为每个对话独立设置 API Key、模型、角色设定等，实现真正的个性化回复。

🚀 快速开始（以 DeepSeek 为例）

DeepSeek 操作最简单：只需填入 API Key 即可使用，无需修改接口地址和模型名称。

1. 注册 DeepSeek 开放平台
2. 进入控制台 → API Keys → 创建新的 API Key 并复制
3. 在脚本设置中将 API Key 粘贴到对应位置
4. 启用自动回复，完成！

💡 DeepSeek 默认接口地址和模型已内置，开箱即用。

🧩 智谱 AI 配置指南

智谱开放平台提供免费体验额度，适合测试使用。详细步骤如下：

1. 注册并登录 智谱开放平台
2. 完成实名认证：前往 账号设置 完成实名认证
3. 创建 API Key：进入 API Key 管理页面，点击创建 API Key 并复制生成的密钥
4. 粘贴 API Key：在脚本设置中将复制的 API Key 粘贴到“API Key”输入框
5. 修改接口地址：将“接口地址”设置为自定义，并填入智谱官方地址：
   ```
   https://open.bigmodel.cn/api/paas/v4/chat/completions
   ```
6. 修改模型：将“模型”设置为自定义，并填入智谱模型名称，例如 glm-4、glm-4v、glm-3-turbo 等
7. 启用自动回复：保存设置并开启自动回复
8. 完成：现在 AI 将使用智谱模型进行回复

🧩 版本说明

由于 QQ 机器人框架不同，本仓库提供两个版本，下载对应版本的压缩包解压后即可得到 main.java：

适用框架：QFun，压缩包：QF_版本号.zip，脚本存放路径：/storage/emulated/0/Android/data/com.tencent.mobileqq/QFun/QQ号/plugin/
适用框架：QStory，压缩包：QS_版本号.zip，脚本存放路径：/storage/emulated/0/Android/data/com.tencent.mobileqq/QStory/Plugin/

请根据你使用的框架选择对应的压缩包下载，解压后将 main.java 放入正确的路径（注意替换 QQ号 为实际号码）。如果路径不存在，请手动创建。

✨ 主要功能

· 每个对话独立配置：可为不同的好友/群聊分别设置 API Key、模型、接口地址、角色设定、超时时间等，互不干扰。
· 主动消息：AI 可根据聊天记录在随机时间主动发起对话，模拟真人互动。
· 群聊延时回复：支持群聊消息合并延时处理，避免刷屏，更像真人。
· 单独对话界面：内置独立聊天窗口，可随时与 AI 进行一对一对话，并单独设置提示词。
· @成员支持：AI 在回复中可使用 @QQ号 格式，自动转换为真正的 @ 标记。
· 记忆管理：自动保存对话历史（JSON 文件），支持清除单个会话或全部记忆。
· 一键加群：菜单中提供“加入交流群”按钮，快速跳转反馈群。

📦 安装方法

1. 下载脚本

· 从本仓库的 Releases 页面下载对应框架的压缩包（QF_版本号.zip 或 QS_版本号.zip）。
· 解压得到 main.java、desc.txt、info.prop。

2. 放置脚本

· QFun 用户：将 压缩包里面的文件 放入 /storage/emulated/0/Android/data/com.tencent.mobileqq/QFun/QQ号/plugin/ 目录（QQ号 替换为你的 QQ 号码）。
· QStory 用户：将 压缩包里面的文件 放入 /storage/emulated/0/Android/data/com.tencent.mobileqq/QStory/Plugin/ 目录。

3. 启用插件

· 打开对应框架的悬浮窗菜单，进入插件管理页面，找到“AI自动回复”并启用。

🚀 使用方法

插件加载后，通过框架的悬浮窗菜单可看到以下选项：

菜单项 功能
AI自动回复设置 打开当前会话的详细配置界面
单独对话 打开独立聊天窗口与 AI 对话
启用自动回复 为当前会话开启自动回复
禁用自动回复 关闭当前会话的自动回复
清除当前会话记忆 清空当前会话的聊天历史
清除全部AI记忆 清空所有会话的聊天历史
恢复默认设置 将全局配置恢复为默认值
对话测试 测试 API 是否连通
加入交流群 一键跳转至反馈群（群号：1028023127）

详细配置说明

在设置界面中可配置以下参数：

· API Key：必填，从模型提供商获取（DeepSeek、智谱等）。
· 接口地址：可选择官方接口或自定义兼容 OpenAI 格式的地址。
    智谱官方接口：https://open.bigmodel.cn/api/paas/v4/chat/completions
    DeepSeek 官方接口已内置，无需修改。
· 模型：内置 deepseek-chat、deepseek-reasoner，也可自定义其他兼容 OpenAI 格式的模型名（如智谱 glm-4、glm-4v、glm-3-turbo 等）。
· 角色设定：定义 AI 的性格、说话方式，越详细效果越好。默认提示词已包含大量真人化约束。
· 请求超时（秒）：API 请求超时时间，复杂模型建议 60 秒以上。
· 当前会话记忆条数：该会话保存的最近对话条数，-1 表示无限制。
· 全局默认记忆条数：新会话默认的记忆条数。
· 群聊设置：
  · 群聊仅 @ 我时回复：开启后只在被 @ 时响应群消息。
  · 启用 AI @ 成员：开启后 AI 回复中的 @QQ号 将自动转换为 @ 标记。
  · 群聊消息延时：开启后在随机延时（可设置最短/最长）后回复，期间多条消息合并处理。
· 主动消息设置：
  · 启用主动消息：AI 会在随机时间主动发言。
  · 最短/最长间隔：主动消息的随机间隔范围。
  · 无回复暂停次数：连续无用户回复达到该次数后暂停主动消息，直到用户发言。


❓ 常见问题

Q：API Key 在哪里获取？
A：推荐使用 DeepSeek（最简单）：https://platform.deepseek.com/
也可使用智谱AI（免费额度）：https://open.bigmodel.cn/
创建 API Key。

Q：为什么 AI 不回复群消息？
A：请检查：① 是否已在当前群启用自动回复；② 是否开启了“群聊仅 @ 我时回复”，若开启则必须被 @ 才会回复；③ API Key 是否正确。

Q：如何清空对话记忆？
A：使用菜单中的“清除当前会话记忆”或“清除全部AI记忆”。

Q：AI 回复太长或太模板化怎么办？
A：在角色设定中调整提示词，默认提示词已加入大量真人化约束，你可以进一步自定义。

Q：主动消息不触发？
A：确保已启用主动消息，并且自动回复开关已打开。主动消息需要一定的聊天记录作为上下文。

Q：脚本应该放在哪个文件夹？
A：请严格按照版本说明中的路径放置，注意替换 QQ号 为实际号码。

Q：如何呼出菜单？
A：通过框架的悬浮窗菜单进入。

💬 反馈与交流

如有问题、建议或需要帮助，欢迎加入反馈群：**1028023127**  
或通过菜单中的“加入交流群”一键跳转。

❤️ 赞助支持

如果你觉得这个项目对你有帮助，欢迎赞助支持我继续开发！你的每一份心意都是持续维护的动力 ✨

- 微信扫码：

![微信收款码](images/wechatpay.png)

- 支付宝扫码：

![支付宝收款码](images/alipay.jpg)

感谢你的支持！🙏

📄 许可证

本项目采用 GPL 许可证，详情请见 [LICENSE](LICENSE) 文件。
